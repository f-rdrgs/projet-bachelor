version: "3.1"

rules:
- rule: Saluer l'utilisateur
  conversation_start: true
  steps:
    - intent: salutation
    - action: utter_que_faire

- rule: Activer messages de debug
  steps:
    - intent: debug
    - action: action_activate_debug_mode
- rule: Récupération horaire
  steps:
    - intent: ask_horaire
    - action: action_ask_horaire

- rule: recommencer
  steps:
    - intent: stop
    - action: restart_convo

- rule: activate Form ressource
  steps:
    - intent: ressource_gather
    - action: predefine_ressource
    - action: get_ressource_form
    - active_loop: get_ressource_form

- rule: Annuler date heure
  condition:
  - active_loop: get_date_heure_form
  steps:
    - intent: annuler
    - action: annuler_date_heure
    - slot_was_set:
        - heure: None
    - slot_was_set:
        - date: None
    - action: get_date_heure_form

- rule: Submit Form ressource
  condition:
  - active_loop: get_ressource_form
  steps:
    - action: get_ressource_form
    - active_loop: null
    - slot_was_set:
      - requested_slot: null
    - action: utter_ressource
    - action: reset_validation
    - action: get_options_reserv_form
    - active_loop: get_options_reserv_form
  wait_for_user_input: false

- rule: Submit List Options
  condition:
  - active_loop: get_options_reserv_form
  steps:
    - action: get_options_reserv_form
    - active_loop: null
    - slot_was_set:
      - requested_slot: null
    - action: list_list_options
    - action: get_date_heure_form
    - active_loop: get_date_heure_form
  wait_for_user_input: false

- rule: Submit Form Date Heure
  condition:
  - active_loop: get_date_heure_form
  steps:
    - action: get_date_heure_form
    - active_loop: null
    - slot_was_set:
      - requested_slot: null
    - action: action_utter_date_heure
    - action: reset_validation
    - action: get_info_reserv_form
    - active_loop: get_info_reserv_form
  wait_for_user_input: false

- rule: Submit Form Nom Prenom
  condition:
  - active_loop: get_info_reserv_form
  steps:
    - action: get_info_reserv_form
    - active_loop: null
    - slot_was_set:
      - requested_slot: null
    - action: utter_nom_prenom
    - action: action_utter_fin_reservation
    - action: reset_validation
    - action: save_ressource
    - action: utter_aurevoir
    - action: action_restart
  wait_for_user_input: false
