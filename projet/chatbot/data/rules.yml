version: "3.1"

rules:
- rule: Saluer l'utilisateur
  conversation_start: true
  steps:
    - intent: salutation
    - action: action_salutation

- rule: recommencer
  steps:
    - intent: annuler
    - action: restart_convo

- rule: activate Form ressource
  steps:
    - intent: ressource_gather
    - action: get_ressource_form
    - active_loop: get_ressource_form

- rule: Submit Form ressource
  condition:
  - active_loop: get_ressource_form
  steps:
    - action: get_ressource_form
    - active_loop: null
    - slot_was_set:
      - requested_slot: null
    - action: utter_confirm_ressource


- rule: handle out_of_context during form
  condition:
    - active_loop: get_ressource_form
  steps:
    - intent: out_of_context
    - action: utter_please_stay_on_topic
    - action: get_ressource_form

- rule: handle other during form
  condition:
    - active_loop: get_ressource_form
  steps:
    - intent: ressource_gather
    - action: utter_please_stay_on_topic
    - action: get_ressource_form

- rule: activate Form Date Heure
  steps:
    - intent: affirm
    - action: get_date_heure_form
    - active_loop: get_date_heure_form

- rule: Submit Form Date Heure
  condition:
  - active_loop: get_date_heure_form
  steps:
    - action: get_date_heure_form
    - active_loop: null
    - slot_was_set:
      - requested_slot: null
    - action: utter_date_heure
    - action: action_restart