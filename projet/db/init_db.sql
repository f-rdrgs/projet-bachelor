CREATE TYPE "jour_semaine" AS ENUM (
  'lundi',
  'mardi',
  'mercredi',
  'jeudi',
  'vendredi',
  'samedi',
  'dimanche'
);

CREATE TABLE "ressource" (
  "label" varchar PRIMARY KEY,
  "description" text
);

CREATE TABLE "jour_horaire" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "jour" jour_semaine NOT NULL,
  "debut" time NOT NULL,
  "fin" time NOT NULL,
  "temps_reservation" time NOT NULL,
  "label" varchar
);

CREATE TABLE "temp_reservation" (
  "label_ressource" varchar NOT NULL,
  "heure" time NOT NULL,
  "date_reserv" date NOT NULL,
  "timestamp_reserv" timestamp NOT NULL,
  PRIMARY KEY ("label_ressource", "heure", "date_reserv")
);

CREATE TABLE "reservation" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "nom" varchar NOT NULL,
  "prenom" varchar NOT NULL,
  "numero_tel" varchar NOT NULL,
  "date_reservation" timestamp NOT NULL
);

CREATE TABLE "reservations_client_resource" (
  "reservation" integer NOT NULL,
  "resource" varchar NOT NULL,
  "date_reservation" date NOT NULL,
  "heure" time NOT NULL,
  PRIMARY KEY ("resource", "date_reservation", "heure")
);

CREATE TABLE "options_resource" (
  "label_resource" varchar NOT NULL,
  "label_option" varchar NOT NULL,
  "description" text,
  PRIMARY KEY ("label_resource", "label_option")
);

CREATE TABLE "options_resource_choix" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "label_option" varchar NOT NULL,
  "choix" varchar NOT NULL
);

ALTER TABLE "options_resource_choix" ADD FOREIGN KEY ("label_option") REFERENCES "options_resource" ("label_option");

ALTER TABLE "options_resource" ADD FOREIGN KEY ("label_resource") REFERENCES "ressource" ("label");

ALTER TABLE "temp_reservation" ADD FOREIGN KEY ("label_ressource") REFERENCES "ressource" ("label");

ALTER TABLE "jour_horaire" ADD FOREIGN KEY ("label") REFERENCES "ressource" ("label");

ALTER TABLE "reservations_client_resource" ADD FOREIGN KEY ("reservation") REFERENCES "reservation" ("id");

ALTER TABLE "reservations_client_resource" ADD FOREIGN KEY ("resource") REFERENCES "ressource" ("label");
